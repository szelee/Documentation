<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CbeWebService.PurchaseConfirmation Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="PurchaseConfirmation method" /><meta name="System.Keywords" content="CbeWebService.PurchaseConfirmation method" /><meta name="Microsoft.Help.F1" content="Vix.Cbe.WebService.CbeWebService.PurchaseConfirmation" /><meta name="Microsoft.Help.Id" content="M:Vix.Cbe.WebService.CbeWebService.PurchaseConfirmation(Vix.Cbe.WebService.Contracts.SalesTransaction.PurchaseConfirmationMessageRequestSpdAuthV1)" /><meta name="Description" content="This case completes the sale with the payment confirmation details for Point to Point, season tickets, railcard sales and Gift eVouchers. (Gift eVouchers are not mixed with other products in a sales transaction." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vix.Cbe.WebService" /><meta name="file" content="73f5379c-3a82-1583-9879-20aaf5edac9e" /><meta name="guid" content="73f5379c-3a82-1583-9879-20aaf5edac9e" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Central Booking Engine Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e7529a28-e260-e3d8-0718-b3fc28f03686.htm" title="Central Booking Engine Class Library" tocid="roottoc">Central Booking Engine Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e7529a28-e260-e3d8-0718-b3fc28f03686.htm" title="Central Booking Engine" tocid="e7529a28-e260-e3d8-0718-b3fc28f03686">Central Booking Engine</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/26210088-6c4f-d952-a0af-51ddaeac4a15.htm" title="Vix.Cbe.WebService" tocid="26210088-6c4f-d952-a0af-51ddaeac4a15">Vix.Cbe.WebService</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/dbe63916-3728-a5c7-9333-dd7d99c307bd.htm" title="CbeWebService Class" tocid="dbe63916-3728-a5c7-9333-dd7d99c307bd">CbeWebService Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/79896919-9212-d834-bb9f-034a8b293c03.htm" title="CbeWebService Methods" tocid="79896919-9212-d834-bb9f-034a8b293c03">CbeWebService Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5e3aa0da-c2cb-4059-d631-61b7ace9e210.htm" title="AddJourneyToFavourites Method " tocid="5e3aa0da-c2cb-4059-d631-61b7ace9e210">AddJourneyToFavourites Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/34d7f448-41a4-9633-668f-45cc8ab9baff.htm" title="AddUpdateCustomerPhotocard Method " tocid="34d7f448-41a4-9633-668f-45cc8ab9baff">AddUpdateCustomerPhotocard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/fe53d4b4-5d18-a895-822c-e84af19f3cba.htm" title="AddUpdatePassengerAssistanceDetails Method " tocid="fe53d4b4-5d18-a895-822c-e84af19f3cba">AddUpdatePassengerAssistanceDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bb0efcb4-605d-2ad1-d791-ac1148d977a7.htm" title="AddUpdateSmartcard Method " tocid="bb0efcb4-605d-2ad1-d791-ac1148d977a7">AddUpdateSmartcard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/8fd64612-4084-58f5-78bb-a0bd7ddf73c6.htm" title="AddUpdateTokenisedPaymentCard Method " tocid="8fd64612-4084-58f5-78bb-a0bd7ddf73c6">AddUpdateTokenisedPaymentCard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0691a6a3-cee2-6282-bcd5-17fd1dc6a9b4.htm" title="AmendReservation Method " tocid="0691a6a3-cee2-6282-bcd5-17fd1dc6a9b4">AmendReservation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/255c6b3b-d8bb-dc1b-6484-8b751b1f5ad6.htm" title="AssignTransactionCashback Method " tocid="255c6b3b-d8bb-dc1b-6484-8b751b1f5ad6">AssignTransactionCashback Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/7921a6e1-abe7-0747-935e-9f6d678d51f5.htm" title="CalculateEVoucherSpend Method " tocid="7921a6e1-abe7-0747-935e-9f6d678d51f5">CalculateEVoucherSpend Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/4cee68ee-6945-9aeb-c2b8-f2454ef2a496.htm" title="CancelReservation Method " tocid="4cee68ee-6945-9aeb-c2b8-f2454ef2a496">CancelReservation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6dd1df64-53da-cff2-e289-305fc56f8bd6.htm" title="ClaimGiftEVouchers Method " tocid="6dd1df64-53da-cff2-e289-305fc56f8bd6">ClaimGiftEVouchers Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bd241bf0-22ed-bcf9-1fd0-8ba53f75d2f4.htm" title="ConfirmThirdPartyAdditionToLoyalty Method " tocid="bd241bf0-22ed-bcf9-1fd0-8ba53f75d2f4">ConfirmThirdPartyAdditionToLoyalty Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/a8e64a42-676d-e496-73ef-79eae0c8e01e.htm" title="CreateCustomerProfile Method " tocid="a8e64a42-676d-e496-73ef-79eae0c8e01e">CreateCustomerProfile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c7233412-6847-716c-57d4-cce47247b369.htm" title="CreateCustomerProfileGuest Method " tocid="c7233412-6847-716c-57d4-cce47247b369">CreateCustomerProfileGuest Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/4d74aeda-dbe5-5696-bf70-d2e87678dfcc.htm" title="CreateCustomerProfilePartial Method " tocid="4d74aeda-dbe5-5696-bf70-d2e87678dfcc">CreateCustomerProfilePartial Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/f9f4a0f9-cbde-ca21-a7d7-a1fc863e89e0.htm" title="CreateReservationChange Method " tocid="f9f4a0f9-cbde-ca21-a7d7-a1fc863e89e0">CreateReservationChange Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/f674e432-ae26-e940-ac4e-2f3328f8e5a5.htm" title="CreateTimetableChange Method " tocid="f674e432-ae26-e940-ac4e-2f3328f8e5a5">CreateTimetableChange Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/63fa2926-afa9-d20c-433d-9927f8a7ea2b.htm" title="CustomerAccountVerification Method " tocid="63fa2926-afa9-d20c-433d-9927f8a7ea2b">CustomerAccountVerification Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/232b25cb-48e5-dd28-cb46-89144e13d09f.htm" title="CustomerChangePassword Method " tocid="232b25cb-48e5-dd28-cb46-89144e13d09f">CustomerChangePassword Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0ec24bae-81fe-9b42-e196-a2fd9658f050.htm" title="DeleteCustomerPhotocard Method " tocid="0ec24bae-81fe-9b42-e196-a2fd9658f050">DeleteCustomerPhotocard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/31ef8bef-5105-f0cf-aebb-dd7872c1f7f2.htm" title="DeleteSmartcard Method " tocid="31ef8bef-5105-f0cf-aebb-dd7872c1f7f2">DeleteSmartcard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/27989709-d920-1103-5ca2-8cbdb838a935.htm" title="DeleteTokenisedPaymentCard Method " tocid="27989709-d920-1103-5ca2-8cbdb838a935">DeleteTokenisedPaymentCard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5bbf1c2d-c64b-8868-b60f-20c0812fee52.htm" title="GetBarcodeDetails Method " tocid="5bbf1c2d-c64b-8868-b60f-20c0812fee52">GetBarcodeDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/881a128f-5701-d557-4243-b28cd6f58c57.htm" title="GetBestFaresInformation Method " tocid="881a128f-5701-d557-4243-b28cd6f58c57">GetBestFaresInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c12caffb-561a-0c8b-e047-f7901890abb9.htm" title="GetCoachesInformation Method " tocid="c12caffb-561a-0c8b-e047-f7901890abb9">GetCoachesInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3732ba35-cede-40a0-a7f3-478dc743b83d.htm" title="GetCoachesSeatAvailability Method " tocid="3732ba35-cede-40a0-a7f3-478dc743b83d">GetCoachesSeatAvailability Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ff677e61-fe72-828b-90f5-d8e80661b9e7.htm" title="GetCompensationList Method " tocid="ff677e61-fe72-828b-90f5-d8e80661b9e7">GetCompensationList Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ec25725f-f524-4b83-be49-c56488a2560a.htm" title="GetCtrDetails Method " tocid="ec25725f-f524-4b83-be49-c56488a2560a">GetCtrDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/57884511-f5dd-6174-794f-2f218d76f468.htm" title="GetCustomerAccountDetails Method " tocid="57884511-f5dd-6174-794f-2f218d76f468">GetCustomerAccountDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/32f221c3-a9a1-6a9d-22e2-5d8e4a2da388.htm" title="GetCustomerEVouchers Method " tocid="32f221c3-a9a1-6a9d-22e2-5d8e4a2da388">GetCustomerEVouchers Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/8fe6e163-639b-e179-6086-e205699236b8.htm" title="GetCustomerKeyValuePairs Method " tocid="8fe6e163-639b-e179-6086-e205699236b8">GetCustomerKeyValuePairs Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ac9aa5d2-1550-9a17-62eb-3859fd2ab8ed.htm" title="GetCustomerPhotocards Method " tocid="ac9aa5d2-1550-9a17-62eb-3859fd2ab8ed">GetCustomerPhotocards Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/cd66527d-587b-f75d-dd76-2be3de34879e.htm" title="GetCustomerSegment Method " tocid="cd66527d-587b-f75d-dd76-2be3de34879e">GetCustomerSegment Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0b0d82f6-b286-6068-438d-06236c3650cb.htm" title="GetETicketUrl Method " tocid="0b0d82f6-b286-6068-438d-06236c3650cb">GetETicketUrl Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/58e3d5a5-78f3-ba25-4e81-5d72a2ddca9f.htm" title="GetFaresInformation Method " tocid="58e3d5a5-78f3-ba25-4e81-5d72a2ddca9f">GetFaresInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/90ed0488-1298-e035-4931-3afb1545f90f.htm" title="GetGoldstarSeasonTickets Method " tocid="90ed0488-1298-e035-4931-3afb1545f90f">GetGoldstarSeasonTickets Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/64473bbc-2477-7f58-cb67-83cc46234c23.htm" title="GetOptionalServices Method " tocid="64473bbc-2477-7f58-cb67-83cc46234c23">GetOptionalServices Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e04cf826-6214-19bd-9d5f-d47f80a0aa77.htm" title="GetPassengerAssistanceDetails Method " tocid="e04cf826-6214-19bd-9d5f-d47f80a0aa77">GetPassengerAssistanceDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e2d1710e-2566-e9e2-ce1e-81d1f8ba2825.htm" title="GetPresalesFulfilmentOptions Method " tocid="e2d1710e-2566-e9e2-ce1e-81d1f8ba2825">GetPresalesFulfilmentOptions Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5081c9fe-f5d9-f95e-793b-8bd4a66bb011.htm" title="GetRefundList Method " tocid="5081c9fe-f5d9-f95e-793b-8bd4a66bb011">GetRefundList Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/96ade62f-6816-2dd6-c57b-48a822bb53d9.htm" title="GetRefundList2 Method " tocid="96ade62f-6816-2dd6-c57b-48a822bb53d9">GetRefundList2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/7cab8e64-1716-1469-0c19-e6bc7260eb28.htm" title="GetReservationAvailability Method " tocid="7cab8e64-1716-1469-0c19-e6bc7260eb28">GetReservationAvailability Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9179f7ea-c307-1e06-1019-efee69516fa9.htm" title="GetRouteInformation Method " tocid="9179f7ea-c307-1e06-1019-efee69516fa9">GetRouteInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/516cd39f-15e5-47c1-ca94-173d44039c88.htm" title="GetSalesHistory Method " tocid="516cd39f-15e5-47c1-ca94-173d44039c88">GetSalesHistory Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e921d2e1-4bd7-53e5-f62d-c1555c7611a3.htm" title="GetSalesTransactionDetails Method " tocid="e921d2e1-4bd7-53e5-f62d-c1555c7611a3">GetSalesTransactionDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/caea0832-5573-2c62-494f-9a7ab3b90053.htm" title="GetSeasonTicketFares Method " tocid="caea0832-5573-2c62-494f-9a7ab3b90053">GetSeasonTicketFares Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/088ec29e-b246-e299-9ae6-1ef118c3471a.htm" title="GetSmartcardIpes Method " tocid="088ec29e-b246-e299-9ae6-1ef118c3471a">GetSmartcardIpes Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/340956af-aee8-38b9-904a-df8143d00f60.htm" title="GetSmartcards Method " tocid="340956af-aee8-38b9-904a-df8143d00f60">GetSmartcards Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ea928f7c-72d2-f860-9d27-b9468540c877.htm" title="GetStoppingPatterns Method " tocid="ea928f7c-72d2-f860-9d27-b9468540c877">GetStoppingPatterns Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5eeb6726-1473-bfaf-d9d9-6f890484023c.htm" title="GetTokenisedPaymentCards Method " tocid="5eeb6726-1473-bfaf-d9d9-6f890484023c">GetTokenisedPaymentCards Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5bc3911d-dcd7-c041-a289-4a0b5e58158e.htm" title="Heartbeat Method " tocid="5bc3911d-dcd7-c041-a289-4a0b5e58158e">Heartbeat Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/721ba3ed-317a-00ba-ff32-9206e2311243.htm" title="Login Method " tocid="721ba3ed-317a-00ba-ff32-9206e2311243">Login Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/2ee37906-bfc8-ec25-1db0-bec3abfd8e8b.htm" title="MoveReservationBooking Method " tocid="2ee37906-bfc8-ec25-1db0-bec3abfd8e8b">MoveReservationBooking Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/56af5009-2b76-1e1a-dda5-a4f8b7b98b7d.htm" title="PurchaseCancellation Method " tocid="56af5009-2b76-1e1a-dda5-a4f8b7b98b7d">PurchaseCancellation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bfc59a45-f62b-3a3b-387d-db0c5fcd01c9.htm" title="PurchaseChangeOfJourney Method " tocid="bfc59a45-f62b-3a3b-387d-db0c5fcd01c9">PurchaseChangeOfJourney Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/73f5379c-3a82-1583-9879-20aaf5edac9e.htm" title="PurchaseConfirmation Method " tocid="73f5379c-3a82-1583-9879-20aaf5edac9e">PurchaseConfirmation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/7c9ce33b-dd80-5aa4-3fa5-cc1bd41ec0c7.htm" title="PurchaseGiftEVouchers Method " tocid="7c9ce33b-dd80-5aa4-3fa5-cc1bd41ec0c7">PurchaseGiftEVouchers Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/f5514bd2-d7a5-ede9-6f30-386eeaffe630.htm" title="PurchaseReservation Method " tocid="f5514bd2-d7a5-ede9-6f30-386eeaffe630">PurchaseReservation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/01d83f5b-1134-5b3d-31d9-c7a5ee6fcef6.htm" title="PurchaseSeasonTicket Method " tocid="01d83f5b-1134-5b3d-31d9-c7a5ee6fcef6">PurchaseSeasonTicket Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/35e4dae7-4bd0-588b-16fa-cf1acd89dcd3.htm" title="PurchaseSmartcard Method " tocid="35e4dae7-4bd0-588b-16fa-cf1acd89dcd3">PurchaseSmartcard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/7e188f66-2458-fa34-156a-fe5b4a33822c.htm" title="PurchaseTicket3 Method " tocid="7e188f66-2458-fa34-156a-fe5b4a33822c">PurchaseTicket3 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d6da0a5f-47e0-3b1f-a52c-d1c4fd6513e1.htm" title="RedeemTravelPass Method " tocid="d6da0a5f-47e0-3b1f-a52c-d1c4fd6513e1">RedeemTravelPass Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9a7cbc02-8112-4bdc-9c77-bccdbeca6005.htm" title="Refund Method " tocid="9a7cbc02-8112-4bdc-9c77-bccdbeca6005">Refund Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/bde28301-dbee-241f-f590-56abb4a12a79.htm" title="RequestItinerary Method " tocid="bde28301-dbee-241f-f590-56abb4a12a79">RequestItinerary Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/42fa9d1f-692d-563d-9a88-78d4997f9da4.htm" title="ResendBookingConfirmation Method " tocid="42fa9d1f-692d-563d-9a88-78d4997f9da4">ResendBookingConfirmation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0332a4eb-b55e-4fbc-e0c2-1de230b8f56d.htm" title="ReservationBooking Method " tocid="0332a4eb-b55e-4fbc-e0c2-1de230b8f56d">ReservationBooking Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/33e8667e-cd9f-3357-ad17-87f9ffebaeea.htm" title="ReservationBooking2 Method " tocid="33e8667e-cd9f-3357-ad17-87f9ffebaeea">ReservationBooking2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1eb86d7c-263a-ec44-b74a-07d866d00251.htm" title="ResetPassword Method " tocid="1eb86d7c-263a-ec44-b74a-07d866d00251">ResetPassword Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/21129e43-b090-09aa-5b3d-0acab28174b8.htm" title="SalesOfferingAuthorisation Method " tocid="21129e43-b090-09aa-5b3d-0acab28174b8">SalesOfferingAuthorisation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d012b078-3e1e-8cd1-5cff-375a34a098d1.htm" title="SalesTransactionStatusUpdate Method " tocid="d012b078-3e1e-8cd1-5cff-375a34a098d1">SalesTransactionStatusUpdate Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b5c96bf0-d246-0901-5eff-c530bba69248.htm" title="SetCustomerKeyValuePairs Method " tocid="b5c96bf0-d246-0901-5eff-c530bba69248">SetCustomerKeyValuePairs Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/68c6c90f-034d-2800-9b49-a7cf0d88f973.htm" title="SetSubscriberDetails Method " tocid="68c6c90f-034d-2800-9b49-a7cf0d88f973">SetSubscriberDetails Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/a81faa63-ff16-3111-bacc-8e4e6a84c906.htm" title="UpdateAdrOptions Method " tocid="a81faa63-ff16-3111-bacc-8e4e6a84c906">UpdateAdrOptions Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ba0221f0-a551-2cdf-379f-e4435d5f6fd3.htm" title="UpdateCustomerProfile Method " tocid="ba0221f0-a551-2cdf-379f-e4435d5f6fd3">UpdateCustomerProfile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c2551d77-bbaf-4c3c-e108-e3751a0933c5.htm" title="UpdateCustomerProfileGuest Method " tocid="c2551d77-bbaf-4c3c-e108-e3751a0933c5">UpdateCustomerProfileGuest Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1a3f95dd-f6a4-ba85-3994-d5b1447fcdb3.htm" title="UpdateLoyaltyCard Method " tocid="1a3f95dd-f6a4-ba85-3994-d5b1447fcdb3">UpdateLoyaltyCard Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/51f9967e-2559-35c2-3c34-5b2fd37a88d7.htm" title="ValidateCustomerPasswordResetToken Method " tocid="51f9967e-2559-35c2-3c34-5b2fd37a88d7">ValidateCustomerPasswordResetToken Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0cd8527e-5c04-d477-b012-44d81fd22f21.htm" title="VerifyCustomerToken Method " tocid="0cd8527e-5c04-d477-b012-44d81fd22f21">VerifyCustomerToken Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>CbeWebService<span id="LSTDA20D4C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDA20D4C_0?cpp=::|nu=.");</script>PurchaseConfirmation Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            This case completes the sale with the payment confirmation details for Point to Point, season tickets,
            railcard sales and Gift eVouchers. (Gift eVouchers are not mixed with other products in a sales
            transaction.) The FEWS provides all the remaining data for fulfilment activities and settlement and
            moves the sales transaction status from Awaiting authorization to Confirmed.
            The FEWS also supports purchase confirmation of a season ticket changeover done by rebook and
            refund.In this case a refund reference number is present in the input.
            This case also allows the FEA to request SMS messages of the itinerary of Point to Point journeys.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="26210088-6c4f-d952-a0af-51ddaeac4a15.htm">Vix.Cbe.WebService</a><br />
    <strong>Assembly:</strong>
   Vix.Cbe.WebService (in Vix.Cbe.WebService.dll) Version: 0.1.0.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[<span class="identifier">PerformanceCounterAttribute</span>(<span class="keyword">true</span>, <span class="keyword">typeof</span>(<span class="identifier">ServiceMethodPerformanceCounter</span>), "CBE-Operation.V7", 
	"Web-PurchaseConfirmation", Target = <span class="identifier">CbeActivity</span>.PurchaseConfirmation)]
<span class="keyword">public</span> <span class="identifier">Task</span>&lt;<span class="identifier">PurchaseConfirmationMessageResponseV1</span>&gt; <span class="identifier">PurchaseConfirmation</span>(
	<span class="identifier">PurchaseConfirmationMessageRequestSpdAuthV1</span> <span class="parameter">request</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">request</span></dt><dd>Type: <a href="3e627540-93bd-0d0c-8ea3-05231fdce771.htm">Vix.Cbe.WebService.Contracts.SalesTransaction<span id="LSTDA20D4C_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDA20D4C_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PurchaseConfirmationMessageRequestSpdAuthV1</a><br />The request.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="https://docs.microsoft.com/dotnet/api/system.threading.tasks.task-1" target="_blank" rel="noopener noreferrer">Task</a><span id="LSTDA20D4C_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDA20D4C_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="e947ede3-5cd5-a1cd-06e8-d4c0d9b7bc14.htm">PurchaseConfirmationMessageResponseV1</a><span id="LSTDA20D4C_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDA20D4C_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />Confirmation of the purchase response wrapped in a response message contract.<h4 class="subHeading">Implements</h4><a href="5a7468eb-2ec2-4e6a-5fa6-45e7f26e8dcd.htm">ICbeWebService<span id="LSTDA20D4C_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDA20D4C_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PurchaseConfirmation(PurchaseConfirmationMessageRequestSpdAuthV1)</a><br /></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p><b>BACKGROUND</b></p><p>
      This FEWS is used to inform the CBE of the payment associated with a sale. The method of payment (MOP) may be by card (debit/credit), or cash or voucher or warrant. The MOP depends on the retail channel and in the case of a ticket office may be one or more of the above MOPs.
    </p><p>
      If the purchase confirmation is for a card payment then the authorisation code from the PSP is sent to the CBE by the FEA. The FEA will receive notification of the authorisation or otherwise from the Payment Service Provider (PSP), this will include a date and time stamped authorisation reference for the payment amount. The payment data is passed back to the CBE to hold against the appropriate sales transaction reference. On receipt of this information the status of the sales transaction in the database then moves to ‘confirmed’.
    </p><p>
      The receipt of the purchase confirmation then triggers the following processes within the CBE:
      <ul><li>the fulfilment processes for the chosen method of fulfilment</li><li>the creation of the SDCI record in the open shift corresponding to the sale</li><li>the issue of emails to the customer confirming the purchase with the sales and journey information</li><li>optionally the issue of SMS to the customer with journey details as requested.</li></ul></p><p>
      The CBE does not hold any payment details other than the authorisation code details (code, date, time, amount) against the sale record to avoid PCI-DSS implications.
    </p><p>
      This call has been updated to support TIS where card holder not present payments are made to include payment card tokenisation details. This affects the Web, Mobile and Call centre retail channels. These card payment details are not required where Chip and PIN payments are made by the customer/cardholder at a TVM, On Board and Ticket Office retail channels.
    </p><p>
      This call also includes support for payment with more than payment card and payment by National and Local Transport Tokens.
    </p><p>
      This updated version includes changes associated with SC CR99 (Customer account enhancements) and the inclusion of the payment card truncated PAN required for TOD collection.
    </p><p><b>BUSINESS PROCESS CONTEXT</b></p><p>
      The diagram below shows the context of where in the ticket purchase process this FEWS call occurs.
    </p><img src="\Content\FEWS 6.2 Purchase Confirmation\Context.jpg" /><p><b>PROCESS DIAGRAM</b></p><p>
      This diagram shows the steps in a typical web retail channel purchase where payment can only be made by payment card. This excludes any refund reference for changeover season ticket purchases).
    </p><img src="\Content\FEWS 6.2 Purchase Confirmation\ProcessDiagram.jpg" /><p><b>PROCESS DESCRIPTION</b></p><p>
      This FEWS completes the sale with the payment confirmation details for Point to Point and season tickets. It provides all the remaining data for fulfilment activities and settlement and moves the sales transaction status in the CBE database from Awaiting Authorisation to Confirmed. The output includes the sales transaction reference and fulfilment details associated with the sale.
    </p><p>
      For credit card payments, the payment and authorisation process is handled by the front end application using a 3rd party payment service provider (PSP). The Front End application then provides the authorisation code to the CBE via this FEWS to show payment approved. This confirmation of payment authorisation triggers the CBE to complete the sales transaction. For TIS where the card holder is not present the use of payment card tokens has been added to give greater security. The input now includes the payment card truncated PAN where TOD fulfilment is required, this must be provided if LSM settings for retail channel in the Admin U.I configuration “Payment Card Required “Settings require MailingFlag to be set to 1 (ie specific card). If this is set to 3 then truncated PAN is not required, hence optionality. The LSM setting in Admin UI needs to be defined and developed, in the interim assume the mailing flag setting is always 1.
    </p><p>
      The revised FEWS call now supports multiple card payments where only one was previously supported.   The call also supports the logical ‘payment’ of reservation only sales which are currently free. In this case there would be no payment authorisation details provided as input. Payments by national and local transport coupons are supported using the MOP value of T to signify a transport token.
    </p><p>
      For web or call centre sales the CBE returns the sales confirmation details and associated data relating to the indirect fulfilment method. For example where the chosen fulfilment is:
      <ul><li>CCST (by post) - the delivery address is included in the output. </li><li>TOD - the CTR number is returned,</li><li>Smart  - the smartcard number is returned.</li></ul></p><p>
      This case also allows the FEA to request SMS messages of the itinerary of journeys, when a mobile phone number is included in the input.
    </p><p>
      For ticket office or TVM sales the CBE carries out direct fulfilment to CCST coupons; in the future this will include the options for direct fulfilment to a smartcard.
    </p><p>
      In the case of a TVM walk up sale the completion of FEWS 6.2 triggers the creation of the a unique print message job, which can then be requested by the TVM using the fetched delivery method using the FEWS 7.2 request.
    </p><p>
      For the On Board channel the CBE does not carry out the ticket printing fulfilment – this is done by the FEA by printing to paper roll.
    </p><p>
      Email confirmations will be conditional on the fulfilment option, the retails channel and the existence of an email address. Email confirmations will only be issued where the retail channel is web/mobile/call centre where an email address is held.
    </p><p>
      The FEA may sell non-rail products in the same customer transaction. These will be unknown to the CBE, therefore the payment card authorisation amount may not equal to the CBE sales transaction value. However it must not be less than the sales transaction value.(See Business validation rules.).
    </p><p>
      Where multiple MOPS combinations are used for payment the CBE will map the correct MOP code for printing on CCST ticket (set by the MOP data table) as per RSP rules. Where smart fulfilment applies with multiple MOPs the MOP data in the smart fulfilment message should be the MOP code which reflects the biggest payment. In cases of season ticket changeover by means of refund and rebook this FEWS is used. In this case a refund reference number is present in the input in addition to a sales transaction reference which relates to the new/changed ticket sale. For all other refunds FEWS 9.4 is used for refunding payments. The payment card details included in the input support payment card tokenisation details if present.  The structure details the card token the value against a card etc and will also be required in any corresponding Refund repayment call (see FEWS 9.4).
    </p><p>
      For TIS where card holder not present applies, (web/mobile/CC retail channels), the card payment and authorisation process is handled by the front end application using a 3rd party payment service provider (PSP) under CHNP rules. For TVM and Ticket Office and On Board retail channels the credit/debit card payments are Chip &amp; PIN authorised using a 3rd party payment service provider (PSP).   The FEA then provides the authorisation details and optionally a card identifier (Token) provided by the PSP, as input to the CBE via this FEW to show successful payment.
    </p><p>
      This call also supports the use of National and Local Transport Tokens at On Board and Ticket office retail channels. When these are used the input MOP must be T, and include a payment sundry code, which corresponds to the transport token.
    </p><p>
      The presence of refund details in the input as well sales details signify that a rebook and refund transaction has taken place (ie to support a changeover season ticket). When a changeover is done if there is an overall credit refund amount which is authorised then only one MOP is allowed (as per rules for refunds), if the net balance is a debit then multiple MOPs are permitted as per a sale.
    </p><p>
      As part of CR99, the FEWS has been updated in order to avoid problems with TOD collection where the payment card will expire between the current date (of purchase) and date of travel/collection. The CBE will check the expiry date of the card and issue an alert message I(not an error) as part of the output where this case arises.
    </p><p>
      A further feature of CR99 is that on receipt of this call the CBE will check the card details used and if they exist against the customer account (not virtual customer id), then the CBE will update a (new) field ‘date card last used’. (DD/MMYY), in the customer account,  (this is then able to be displayed when FEWS 4.1.5 get card details is called).
    </p><p><b>ASSUMPTIONS</b></p><p><ol><li>It is assumed that as the front end is the interface with the Payments Service Provider for Credit and debit card payments, any charges associated with payments will be included in the authorisation amount input to the CBE without breaking these charges out</li><li>It is assumed that email confirmations are sent for all Web channel sales. The email address in the customer account details will be used. </li><li>The authorisation code is assumed to be a 20 character string, to ensure sufficient for all eventualities for all MOPs.  It is assumed that that the FEA authenticates the source and there is adequate security between the FEA and the CBE.</li><li>It is assumed that the Payment Service Provider, (PSP) will include a transaction reference in their response to the payment card request. This will be passed to the CBE and used for any future refund repayment.</li><li>It is assumed that as the FEA interfaces with the PSP, the FEA will deal with failures in authorising card payments and that no failure messages will be sent to the CBE. The FEA will interact with the customer to get the payment authorised or else the sale will not complete and remain in a pending state. The customer will either give up (the sale stays in a pending state), or else the customer uses a different card or different MOP to complete the sale. The CBE does not need to hold the failure details. </li><li>It is assumed that the TOC will define the MOPs which are valid for each retail channel and supply this to the CBE as an import file on set up with any modifications or additional MOPS submitted as further import files under strict change control. </li><li>It is assumed that the FEA will control and limit the number of multiple MOPs in a sales transaction for each retail channel, in order for the CBE to be generic as possible in this area.  </li><li>It is assumed that any future new MOPS which are added will need to be controlled by the FEA to provide the data required to the CBE to map into the corresponding SDCI payment type (whatever this may be). The mapping to any new SDCI+ record type for a new MOP will require a code change. New MOPs which map onto existing SDCI+ types will only require a new table mapping entry (configuration change).  </li><li>It is assumed that Chip and Payments at Ticket office (or TVM) will be processed through SC’s chosen PSP and not use RSP card payment service. This means that the CBE will only write CW records for non RSP payment acquirer. </li><li>It is assumed that the FEA will convert any other currency types into sterling for the CBE which will handle only sterling (in line with Lennon). </li><li>It is assumed all warrants are automated warrants so therefore CZ records will be written for warrants in SDCI+ and no CW records will be written for warrants.  </li><li>It is assumed that SMS messages will be for UK registered mobiles only and that the mobile phone number for the SMS message need not be the number registered in the Customer’s account details, this is not checked nor used by the CBE for purchase confirmation. It will be the responsibility of the FEA to capture this number. </li><li>The presence of refund details in the input as well sales details signify that a rebook and refund transaction has taken place (ie to support a changeover season ticket). </li><li>It is assumed that in the future this FEWS will be updated to be used in place of FEWS 9.4 (refund confirmation).  </li><li>It is assumed that for RSP purposes the mailing flag will be set to 1. It is assumed that SC will have a business process for business purchases using a corporate card where the passenger will not have these details and will require the passenger to collect the TOD at a ticket office window.   </li><li>It is assumed that the FEA will manage the customer experience when the CBE returns an LSM is unavailable error (no 32) and no CTR can be placed for TOD fulfilment.  (Does not apply to TVM).  </li><li>It is assumed that where a payment has been taken by the FEA and PSP for a TOD sale with a card that the FEA will check that the expiry date of the card does not occur before the outbound travel date of the journey. The FEA should prevent this card being used to avoid issues with TOD collection. However the CBE will also check this and include an alert message with the output. It is assumed if this is received by the FEA they will advise the customer to collect their TOD before their card expires.   </li><li>It is assumed that eVoucher purchases will be paid for with a payment card as the appropriate method of payment (MOP=X) for the web and mobile RC. (An eVoucher cannot be paid for with another eVoucher.)</li></ol></p><p><b>VALIDATIONS</b></p><p>
      Parameter Validation:
      <ol><li>Authorisation Date and Time</li><li>SMS Mobile Number (Basic UK validation: minimum 11 numerics, beginning 07 or +447)</li><li>Truncated PAN 10 numerics</li><li>AuthorizationId –String (19)</li><li>CorrelationId – string (20)</li><li>MerchantReferenceCode –string (50)</li><li>ReceiptId – String (19)</li><li>RequestId – String (26)</li><li>RequestToken- String (256)</li><li>TransactionId – String(17)</li><li>Wallet code – String(4)</li></ol></p><p>
      Business Validation:
      <ol start="11"><li>
          All mandatory items must be present
        </li><li>
          Customer Id is correct for the Transaction Number.
        </li><li>
          The transaction number exists and is in correct state i.e.  Awaiting authorization.
        </li><li>
          If there is no Refund Reference Number: The Total amount must be &gt;=0 and &gt;= the sales transaction value, (from the values in the sales transaction record).
        </li><li>
          Where retail channel is web/mobile/CC and MOP = X and if the difference between the sales transaction date &amp; time and system date &amp; time is more than n minutes (where n is configurable and is set to 10mins initially), reject the transaction with error message “Payment date &amp; time exceeds payment window tolerance.”
        </li><li>
          If there is a Refund Reference number indicating a changeover season ticket: The Total amount &gt;= (the sales transaction value – refund value) (From the values in the sales transaction record and the refund record.) Note: the Total amount may be 0 or &lt;0
        </li><li>
          If Retail Channel is Call Centre or Ticket Office then User credentials must be valid and logged on with the correct access role.
        </li><li>
          Each Method of Payment (MOP) indicator a) exists and b) is one of valid list of MOPS for the retail channel (as provided in the MOP data table by SC see assumption 5).
        </li><li>
          Where multiple MOPs are input the combination set exists within the MOP data table sheet (see Solution design/Requirements/Ticket office/MOP data table) as valid for CCST.
        </li><li>
          If multiple MOPs are input check that the authorisation amount is &gt;0. (For negative amounts only one MOP can be used).
        </li><li>
          Where the MOP is not Rail Vouchers (V) only, the Total Amount should equal the sum of all MOP amounts. (There may be an over payment using Rail Travel Vouchers of a fixed value.)
        </li><li>
          Check the input data of MOP data details is valid against the current MOP data table (See Solutions design/Requirements/Ticket Office/MOP data table,).
        </li><li>
          The number of MOP payments does not exceed those permitted within the MOP data table sheet (see Solution design/Requirements/Ticket office/MOP data table).
        </li><li>
          Where the MOP is Warrant or Rail Voucher the warrant/voucher account number must be validated against the list of valid warrants provided via the Lennon reference data set.
        </li><li>
          Where the MOP payment is warrant or Rail Voucher the warrant/voucher account number must be 6 char, and the warrant/voucher number must be 7 chars.
        </li><li>
          Check the operator/user credentials has permission for this call (see latest version of FEWS Permissions)
        </li><li>
          If a refund reference number is present then the MOP payment cannot be warrant.
        </li><li>
          Using the sales transaction number check that sales transaction ticket has not been cancelled.
        </li><li>
          A valid sales point detail must be provided if RC = TVM, web or mobile else valid user credentials provided where RC = CC or TOM
        </li><li>
          Using the sales transaction number, where for seasons tickets, check that it has not been refunded with refund category type = season other. In case of changeover (refund number present) and the authorisation amount is negative then the MOP validation must be as per FEWS 9.4.
        </li><li>
          In case of changeover (refund number present) if positive value then multiple MOP is permitted as for normal sales.  See note 31.
        </li><li>
          If refund reference is present then Retail Channel should be either ticket office or Call Centre.
        </li><li>
          If the Payment Sundry Code exists, validate against the Lennon Sundry’s data.
        </li><li>
          Fields in SDCI Transaction Details must match to previously called Purchase Ticket (FEWS 6.1). For SDCI Transaction Detail targeting ordered ticket, travelcard or plusbus is Ticket Type and Status Code mandatory. For SDCI Transaction Detail targeting supplement is Supplement Code mandatory. SDCI Transaction Details must not contain duplicate entries – combination Item Number + Ticket Type + Status Code.
        </li><li>
          If Retail channel is TVM/Ticket office/On board (where card holder present transactions verified by C&amp;P), and MOP =X then the following fields should be absent:
          PSP TokenPSP Payment Card Expiry Date</li><li>
          If retail channel is Web/Mobile/CC (where card holder not present), and MOP = X then the following data items must be present:
          PSP Payment Card Expiry DatePSP Token</li><li>
          Truncated PAN must be provided if LSM settings for retail channel in the Admin U.I configuration “Payment Card Required “Settings require MailingFlag to be set to 1 (ie specific card). If this is set to 3 then truncated PAN is not required, hence optionality. The LSM setting in Admin UI needs to be defined and developed, in the interim assume the mailing flag setting is always 1.
        </li><li>
          Card id must exist in customer account
        </li><li>
          Either card id is provided OR Card details but not both.
        </li><li>
          Evoucher(s) must have enough remaining balance to complete the transaction.
        </li><li>
          Where MOP is D (for digital), the 4-character wallet code must exist and the wallet provider must be active.
        </li><li>
          If the Admin Ui settings for the wallet state instrument token is required, this field must be present and populated.
        </li><li>
          If the Admin UI settings for the wallet state reconciliation field 4 is required, this field must be present and populated.
        </li></ol></p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EABABBA_tab1" class="codeSnippetContainerTabSingle">Example PurchaseConfirmation Request</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABABBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EABABBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABABBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">soapenv:Envelope</span> <span class="highlight-xml-attribute-name">xmlns:soapenv</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://schemas.xmlsoap.org/soap/envelope/"</span> <span class="highlight-xml-attribute-name">xmlns:ns</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://vixtechnology.com/cbe/2012-05-29"</span><span class="highlight-xml-bracket">&gt;</span>
   <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">soapenv:Header</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:SalesPointDetails</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:Nlc</span><span class="highlight-xml-bracket">&gt;</span>9999<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:Nlc</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:WindowNumber</span><span class="highlight-xml-bracket">&gt;</span>1<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:WindowNumber</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:MachineNumber</span><span class="highlight-xml-bracket">&gt;</span>0001<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:MachineNumber</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:SalesPointDetails</span><span class="highlight-xml-bracket">&gt;</span>
   <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">soapenv:Header</span><span class="highlight-xml-bracket">&gt;</span>
   <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">soapenv:Body</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:PurchaseConfirmationRequest</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:CustomerId</span><span class="highlight-xml-bracket">&gt;</span>9131<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:CustomerId</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:TransactionNumber</span><span class="highlight-xml-bracket">&gt;</span>17S0V519FI<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:TransactionNumber</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:RefundReferenceNumber</span> <span class="highlight-xml-attribute-name">xsi:nil</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-attribute-name">xmlns:xsi</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">/&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:Payments</span><span class="highlight-xml-bracket">&gt;</span>
            <span class="highlight-xml-comment">&lt;!--Zero or more repetitions:--&gt;</span>
            <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:PaymentDetails</span><span class="highlight-xml-bracket">&gt;</span>
               <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:MopIndicator</span><span class="highlight-xml-bracket">&gt;</span>D<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:MopIndicator</span><span class="highlight-xml-bracket">&gt;</span>
               <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:AuthorisationDateTime</span><span class="highlight-xml-bracket">&gt;</span>2017-11-30T08:46:20<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:AuthorisationDateTime</span><span class="highlight-xml-bracket">&gt;</span>
               <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:AuthorisationAmount</span><span class="highlight-xml-bracket">&gt;</span>950<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:AuthorisationAmount</span><span class="highlight-xml-bracket">&gt;</span>
               <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
               <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:PaymentSundryCode</span> <span class="highlight-xml-attribute-name">xsi:nil</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-attribute-name">xmlns:xsi</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">/&gt;</span>
               <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
               <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:ElectronicWalletDetails</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:WalletCode</span><span class="highlight-xml-bracket">&gt;</span>ABCD<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:WalletCode</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:MerchantReferenceCode</span><span class="highlight-xml-bracket">&gt;</span>MRC<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:MerchantReferenceCode</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:WalletProviderReference</span><span class="highlight-xml-bracket">&gt;</span>WPR<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:WalletProviderReference</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:InstrumentToken</span><span class="highlight-xml-bracket">&gt;</span>IT<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:InstrumentToken</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:ReconciliationField4</span><span class="highlight-xml-bracket">&gt;</span>RF4<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:ReconciliationField4</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:AdditionalDetail1</span><span class="highlight-xml-bracket">&gt;</span>AD1<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:AdditionalDetail1</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
                  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:AdditionalDetail2</span><span class="highlight-xml-bracket">&gt;</span>AD2<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:AdditionalDetail2</span><span class="highlight-xml-bracket">&gt;</span>
                  <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>

               <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:ElectronicWalletDetails</span><span class="highlight-xml-bracket">&gt;</span>
               <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
            <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:PaymentDetails</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:Payments</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:TotalAmount</span><span class="highlight-xml-bracket">&gt;</span>950<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:TotalAmount</span><span class="highlight-xml-bracket">&gt;</span>
         <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
         <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ns:MobileNumber</span> <span class="highlight-xml-attribute-name">xsi:nil</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span> <span class="highlight-xml-attribute-name">xmlns:xsi</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">/&gt;</span>
         <span class="highlight-xml-comment">&lt;!--Optional:--&gt;</span>
      <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ns:PurchaseConfirmationRequest</span><span class="highlight-xml-bracket">&gt;</span>
   <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">soapenv:Body</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">soapenv:Envelope</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABABBA");</script><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABBA_tab1" class="codeSnippetContainerTabSingle">Example PurchaseConfirmation Response</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">s:Envelope</span> <span class="highlight-xml-attribute-name">xmlns:s</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://schemas.xmlsoap.org/soap/envelope/"</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">s:Header</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PerformanceInformation</span> <span class="highlight-xml-attribute-name">xmlns</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://vixtechnology.com/cbe/2012-05-29"</span> <span class="highlight-xml-attribute-name">xmlns:i</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">CbeExecutionTime</span><span class="highlight-xml-bracket">&gt;</span>16148<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">CbeExecutionTime</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ExternalExecutionTime</span><span class="highlight-xml-bracket">&gt;</span>0<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ExternalExecutionTime</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">PerformanceInformation</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">FewsInformation</span> <span class="highlight-xml-attribute-name">xmlns</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://vixtechnology.com/cbe/2012-05-29"</span> <span class="highlight-xml-attribute-name">xmlns:i</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">ReferenceNumber</span><span class="highlight-xml-bracket">&gt;</span>6.2<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">ReferenceNumber</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Revision</span> <span class="highlight-xml-attribute-name">i:nil</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"true"</span><span class="highlight-xml-bracket">/&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Version</span><span class="highlight-xml-bracket">&gt;</span>38.1<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">Version</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">FewsInformation</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">s:Header</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">s:Body</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">PurchaseConfirmationResponse</span> <span class="highlight-xml-attribute-name">xmlns</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://vixtechnology.com/cbe/2012-05-29"</span> <span class="highlight-xml-attribute-name">xmlns:i</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">TransactionNumber</span><span class="highlight-xml-bracket">&gt;</span>17S0V519FI<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">TransactionNumber</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Email</span><span class="highlight-xml-bracket">&gt;</span>martin.svoboda@vixtechnology.com<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">Email</span><span class="highlight-xml-bracket">&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">SdciTransactionDetails</span><span class="highlight-xml-bracket">/&gt;</span>
      <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">AlertMessages</span><span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">PurchaseConfirmationResponse</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">s:Body</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">s:Envelope</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABBA");</script></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Revision History</span></div><div id="ID4RBSection" class="collapsibleSection"><table><tr><th>Date</th><th>Version</th><th>Description</th></tr><tr><td>04/12/2017</td><td>38.1</td><td>FEWS 6.2 Purchase Confirmation</td></tr></table></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID5RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="dbe63916-3728-a5c7-9333-dd7d99c307bd.htm">CbeWebService Class</a></div><div class="seeAlsoStyle"><a href="26210088-6c4f-d952-a0af-51ddaeac4a15.htm">Vix.Cbe.WebService Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>